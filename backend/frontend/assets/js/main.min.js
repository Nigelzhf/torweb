function monitor_system_status(){$.ajax({type:"get",dataType:"json",url:"/api/systemstatus",success:function(e,t){if(0==e.errorcode){var e=e.data;console.log(e),$(".cpu-per").html(e.cpu_per+"%"),$(".ram-per").html(e.ram_per+"%"),$(".net-conn").html(e.net_conn),$(".os-start").html(e.os_start)}}}),setTimeout(monitor_system_status,5e3)}function change_theme(){$(".color").on("click",function(e){var t=$(e.target).attr("color");$.cookie("theme",t,{expires:30}),$.ajax({type:"post",dataType:"json",url:"/useropt",data:JSON.stringify({opt:"update-theme",data:{theme:t}}),success:function(e,t){0==e.errorcode?$.notify("主题保存成功"):1==e.errorcode&&alert(e.txt)}}),$("#theme").attr("href","/assets/css/index."+t+".css")})}function set_theme(){var e=$.cookie("theme");e&&$("#theme").attr("href","/assets/css/index."+e+".css")}function change_image_preview(){$inputFileElm=$(this);var e=document.getElementById("avatar-preview"),t=document.getElementById("avatar");console.log(e),console.log(t);var o=t.value.substring(t.value.lastIndexOf(".")+1).toLowerCase();if("png"!=o&&"jpg"!=o&&"jpeg"!=o)return void alert("文件必须为图片！");if(t.size>3072e3)return void alert("上传图片不要超过3000KB");if(document.all){t.select();var a=document.selection.createRange().text,i=/msie 6/i.test(navigator.userAgent);i?e.src=a:(e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod='image',src=\""+a+'")',e.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==")}else{var n=t.files[0],s=new FileReader;s.readAsDataURL(n),s.onload=function(t){e.src=this.result,$(e).cropper("reset").cropper("replace",this.result)}}$inputFileElm.val("")}function html5Reader(e){var e=e.files[0],t=new FileReader;t.readAsDataURL(e),t.onload=function(e){var t=document.getElementById("avatar-preview");t.src=this.result}}function show_hide_cate_nav(){$(".card-header-all-bt, .card-header:after").mouseenter(function(e){$(".card-header-all").fadeIn(500)}),$(".all-cate-card").mouseleave(function(e){$(".card-header-all").css("display","none")})}function post_new_show_hide_cate(){$(".post-new-html #topic").on("click",function(e){$(".card-header-all").css("display","block")}),$(".post-new-html .card-header-all-cate a").on("click",function(e){$(".card-header-all").css("display","none"),$("#topic").val($(this).html())})}function show_hide_emoji_list(){$("#emoji-btn").on("mousedown",function(e){$("#summernote").summernote("saveRange")}).on("click",function(e){e.preventDefault(),e.stopPropagation(),$("#emoji-list").css("display","block")})}function add_action_emoji_img_summernote(){$("#emoji-list img.emoji").on("click",function(e){var t=$("#summernote");t.summernote("restoreRange"),t.summernote("insertImage",e.target.src,function(e){e.addClass("emoji"),e.css("width","20px")})})}function add_action_emoji_char_summernote(){$("#emoji-list li.emoji").on("click",function(e){var t=$("#summernote");t.summernote("restoreRange");var o=$('<span class="emoji">'+window.emojiJSON[e.target.attributes.em.value].char+"</span>");t.summernote("insertNode",o[0])})}function load_emoji_summernote(){for(var e=["smile","blush","grin","heart_eyes","relaxed","sweat_smile","joy","flushed","confused","unamused","sob","cold_sweat","sweat","scream","sleepy","mask"],t=0;t<e.length;t++)$("#emoji-list").append('<img class="emoji" src="/static/images/emoji/basic/'+e[t]+'.png">');add_action_emoji_img_summernote(),$.getJSON("/static/images/emoji/emojis.json",function(e){window.emojiJSON=e,$("#emoji-list").append('<li class="emoji" em="heart">'+emojiJSON.heart.char+"</li>"),add_action_emoji_char_summernote()})}function show_hide_emoji_list_medium(){$("#emoji-btn").on("click",function(e){e.preventDefault(),e.stopPropagation(),$("#emoji-list").css("display","block")})}function add_action_emoji_img_medium(){$("#emoji-list img.emoji").on("click",function(e){var t=$("#mediumeditor");t.append('<img src="'+e.target.src+'" class="emoji">')})}function add_action_emoji_char_medium(){$("#emoji-list li.emoji").on("click",function(e){var t=$("#mediumeditor");t.append('<span class="emoji">'+window.emojiJSON[e.target.attributes.em.value].char+"</span>")})}function load_emoji_medium(){for(var e=["smile","blush","grin","heart_eyes","relaxed","sweat_smile","joy","flushed","confused","unamused","sob","cold_sweat","sweat","scream","sleepy","mask"],t=0;t<e.length;t++)$("#emoji-list").append('<img class="emoji" src="/static/images/emoji/basic/'+e[t]+'.png">');add_action_emoji_img_medium(),$.getJSON("/static/images/emoji/emojis.json",function(e){window.emojiJSON=e,$("#emoji-list").append('<li class="emoji" em="heart">'+emojiJSON.heart.char+"</li>"),add_action_emoji_char_medium()})}function getFriendlyTime(e){if(e=e.replace("-","/"),e=e.replace("-","/"),console.log(e),!e)return"biu...";var t=Date.now()-Date.parse(e),o=6e4,a=36e5,i=864e5,n=6048e5,s=2592e6,r=31536e6;return t<2*o?"A moment ago":t<a?Math.floor(t/o)+" mins ago":t<i?1==Math.floor(t/a)?"an hour ago":Math.floor(t/a)+" hrs ago":t<n?1==Math.floor(t/i)?"yesterday":Math.floor(t/i)+" days ago":t<s?1==Math.floor(t/n)?"last week":Math.floor(t/n)+" weeks ago":t<r?1==Math.floor(t/s)?"last month":Math.floor(t/s)+" months ago":1==Math.floor(t/r)?"an year ago":Math.floor(t/r)+" yrs ago"}function replate_friendly_time(){$(".friendly-time").each(function(e,t){$(t).html(getFriendlyTime($(t).html()))})}$(document).on("mouseover",".dropdown",function(){$(this).find(".dropdown-menu").show()}),$(document).on("mouseout",".dropdown",function(){$(this).find(".dropdown-menu").hide()}),$(document).click(function(){$("#emoji-list").is(":hidden")||$("#emoji-list").hide()}),$(document).ready(function(){change_theme()});